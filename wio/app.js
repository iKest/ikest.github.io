(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{20:function(m,E,e){m.exports=e(44)},21:function(m,E,e){var R=e(22),c=e(23);c=c.__esModule?c.default:c,typeof c=="string"&&(c=[[m.i,c,""]]);var i={};i.insert="head",i.singleton=!1;var T=R(c,i);m.exports=c.locals||{}},23:function(m,E,e){},44:function(m,E,e){"use strict";e.r(E);var R=e(21),c=e(0),i=e.n(c),T=e(1),b=e.n(T),D=e(10),M=e.n(D),U=e(6),S=e.n(U),N=e(19),C=e(18),I=e(17);const z={type:i.a.AUTO,disableContextMenu:!0,render:{transparent:!0},scale:{parent:"gameContainer",mode:i.a.Scale.NONE,width:"100%",height:"100%",expandParent:!1}},X=(()=>{const s=[];let o=!1;const h=()=>{o||(o=!0,window.requestAnimationFrame?window.requestAnimationFrame(r):setTimeout(r,66))},r=()=>{s.forEach(function(l){l()}),o=!1},a=l=>{l&&s.push(l)};return{add:l=>{s.length||window.addEventListener("resize",h),a(l)}}})(),x=function(){var s,o,h,r,a,l;const d=document.createElement("canvas").getContext("2d"),y=(s=window.devicePixelRatio)!=null?s:1,L=(l=(a=(r=(h=(o=d.webkitBackingStorePixelRatio)!=null?o:d.mozBackingStorePixelRatio)!=null?h:d.msBackingStorePixelRatio)!=null?r:d.oBackingStorePixelRatio)!=null?a:d.backingStorePixelRatio)!=null?l:1,w=y/L;return w>1?w:1}();class O extends i.a.Scene{constructor(s){super(s);this.key=s.key,this.log=b.a.get(this.key),this.log.info("boot")}init(){this.log.info("init"),this.events.once("shutdown",this.shutdown,this),this.events.once("sleep",this.sleep,this),this.events.once("pause",this.pause,this),this.events.off("destroy",this.destroy,this),this.scale.on("resize",this.resize,this)}shutdown(){this.log.info("shutdown"),this.scale.off("resize",this.resize,this),this.events.off("sleep",this.sleep,this),this.events.off("pause",this.pause,this),this.events.once("destroy",this.destroy,this)}sleep(){this.log.info("sleep"),this.events.off("pause",this.pause,this),this.events.once("wake",this.wake,this)}pause(){this.log.info("pause"),this.events.once("resume",this.resume,this)}wake(){this.log.info("wake"),this.events.once("sleep",this.sleep,this),this.events.once("pause",this.pause,this)}resume(){this.log.info("resume"),this.events.once("pause",this.pause,this)}destroy(){this.log.info("destroy"),this.scale.off("resize",this.resize,this),this.events.off("sleep",this.sleep,this),this.events.off("pause",this.pause,this),this.events.off("shutdown",this.shutdown,this),this.log=void 0}resize(s,o,h,r){const{width:a,height:l}=s;this.cameras.resize(a,l)}}class B extends O{constructor(){super({key:"BootScene"})}create(){this.log.info("create"),this.load.rexWebFont({google:{families:["Roboto"]}}),this.load.image("level_bg_tile","assets/images/backgrounddetailed2.png"),this.load.image("restart","assets/images/restart.png"),this.load.spritesheet("spider","assets/sprites/spider.png",{frameWidth:120,frameHeight:148,startFrame:0,endFrame:18}),this.load.on("complete",()=>{this.anims.create({key:"walk",frames:"spider",frameRate:19,repeat:-1}),document.querySelector(".loader").classList.toggle("loaded"),this.scene.start("LevelScene")}),this.load.start()}}var F=e(13),J=e.n(F),tt=e(43),W=e(14),V=e.n(W),Y=e(15),H=e.n(Y),K=e(16),Q=e.n(K);const Z=.005,k=.001;class $ extends O{constructor(){super({key:"LevelScene"});this.currentPointer=null,this.isWalk=!1,this.currentRotation=0,this.crash=new J.a,this.points=[],this.inside=!0,this.drawing=!1,this.startIndex=null,this.endIndex=null}create(){this.log.info("create");const{centerX:s,centerY:o,width:h,height:r}=this.cameras.main;this.bg=this.add.tileSprite(s,o,h+1e3,r+1e3,"level_bg_tile").setOrigin(.5).setScrollFactor(0),this.web=this.createWeb(0,0,300,50),this.webGraphics=this.add.graphics(0,0),this.webGraphics.lineStyle(4,15713599,1),this.webGraphics.fillStyle(10053375),this.webGraphics.beginPath(),this.webGraphics.moveTo(this.web[0].x,this.web[0].y);for(let a=1;a<this.web.length;a++)this.webGraphics.lineTo(this.web[a].x,this.web[a].y);this.webGraphics.closePath(),this.webGraphics.fillPath(),this.webGraphics.strokePath(),this.graphics=this.add.graphics(0,0),this.graphics.lineStyle(16,65280,.5),this.spider=this.add.sprite(0,0,"spider").play("walk").setRotation(this.currentRotation+Math.PI*.5),this.path=this.add.path(this.spider.x,this.spider.y),this.cameras.main.startFollow(this.spider,!0),this.bg.x=s-this.cameras.main.scrollX%500,this.bg.y=o-this.cameras.main.scrollY%500,this.joystick=this.rexVirtualJoystick.add(this,{x:0,y:0,radius:100,base:this.add.circle(0,0,100,16777215,.5),thumb:this.add.circle(0,0,50,2290649224,.5),fixed:!0,enable:!1}).setVisible(!1).on("update",this.dumpJoyStickState,this),this.restartBtn=this.rexButtonn.add(this.add.image(h-10,10,"restart").setScale(.4).setOrigin(1,0).setScrollFactor(0)).setEnable(!0).on("click",()=>{this.restartGame()}),this.crash.onCollision(this.onCollision.bind(this)),this.input.on("pointerdown",this.pressDown,this),this.input.on("pointerup",this.pressUp,this)}createWeb(s,o,h,r){const a=new i.a.Geom.Circle(s,o,h);return a.getPoints(!1,r)}resize(s,o,h,r){super.resize(s,o,h,r);const{width:a,height:l,centerX:d,centerY:y}=this.cameras.main;this.bg.setSize(a+1e3,l+1e3).setOrigin(.5),this.restartBtn.gameObject.setPosition(a-10,10),this.bg.x=d-this.cameras.main.scrollX%500,this.bg.y=y-this.cameras.main.scrollY%500}dumpJoyStickState(){}pressDown(s){if(this.currentPointer!==null)return;this.currentPointer=s;const{x:o,y:h}=s;this.joystick.setPosition(o,h).setVisible(!0).setEnable(!0)}pressUp(s){if(this.currentPointer!==s)return;this.currentPointer=null,this.joystick.setVisible(!1).setEnable(!1)}restartGame(){this.log.info("click restart"),this.scene.restart()}onCollision(s,o,h){this.log.info("collide"),this.graphics.clear(),this.graphics.lineStyle(16,65280,.5),this.crash.clear(),this.firstSegment=!0}update(s,o){if(this.joystick.force===0)return;const h=Math.abs(i.a.Math.Angle.ShortestBetween(this.joystick.angle,i.a.Math.RadToDeg(this.currentRotation)));if(h!==0){const n=o*Z*this.joystick.force,p=n<h?n:h;this.currentRotation=i.a.Math.Angle.RotateTo(this.currentRotation,this.joystick.rotation,p/h),this.spider.rotation=this.currentRotation+Math.PI*.5}let{x:r,y:a}=this.spider;const l=o*this.joystick.force*k*Math.cos(this.currentRotation),d=o*this.joystick.force*k*Math.sin(this.currentRotation);this.spider.x+=l,this.spider.y+=d;const{centerX:y,centerY:L}=this.cameras.main;this.bg.x=y-this.cameras.main.scrollX%500,this.bg.y=L-this.cameras.main.scrollY%500;const w=new i.a.Geom.Line(r,a,this.spider.x,this.spider.y),g=new i.a.Geom.Point;let f=!1;if(this.inside)for(let n=0;n<this.web.length;n++){const p=n+1<this.web.length?this.web[n+1]:this.web[0],P=new i.a.Geom.Line(this.web[n].x,this.web[n].y,p.x,p.y);if(f=i.a.Geom.Intersects.LineToLine(w,P,g),f){this.startIndex=n,this.inside=!1,this.drawing=!0,this.points.push(i.a.Geom.Point.Clone(g)),r=g.x,a=g.y;break}}else for(let n=0;n<this.web.length;n++){const p=n+1<this.web.length?this.web[n+1]:this.web[0],P=new i.a.Geom.Line(this.web[n].x,this.web[n].y,p.x,p.y);if(f=i.a.Geom.Intersects.LineToLine(w,P,g),f){if(this.drawing){this.endIndex=n,this.graphics.clear(),this.graphics.lineStyle(16,65280,.5),this.webGraphics.clear(),this.points.push(i.a.Geom.Point.Clone(g)),this.webGraphics.beginPath();const u=V()(this.points,.8,!1);this.log.info(this.points.length,"-->",u.length);const _=new Q.a(u),A=_.winding();if(this.log.info(A,this.startIndex,this.endIndex),A)if(this.startIndex>=this.endIndex)for(let t=this.endIndex+1;t<=this.startIndex;t++)u.push(this.web[t]);else{for(let t=this.endIndex;t>0;t--)u.push(this.web[t]);for(let t=0;t<this.startIndex;t++)u.push(this.web[t])}else if(this.startIndex<=this.endIndex)for(let t=this.endIndex;t>this.startIndex;t--)u.push(this.web[t]);else{for(let t=this.endIndex;t>0;t--)u.push(this.web[t]);for(let t=0;t<this.startIndex;t++)u.push(this.web[t])}const j=H.a.union([this.web.map(t=>[t.x,t.y])],[u.map(t=>[t.x,t.y])]);this.log.info(j),this.web=j[0][0].map(t=>new i.a.Geom.Point(t[0],t[1])),this.webGraphics.lineStyle(4,15713599,1),this.webGraphics.fillStyle(10053375),this.webGraphics.beginPath(),this.webGraphics.moveTo(this.web[0].x,this.web[0].y);for(let t=1;t<this.web.length;t++)this.webGraphics.lineTo(this.web[t].x,this.web[t].y);this.webGraphics.closePath(),this.webGraphics.fillPath(),this.webGraphics.strokePath(),this.points.length=0}this.inside=!0,this.drawing=!1;break}}if(this.drawing)if(this.graphics.lineBetween(r,a,this.spider.x,this.spider.y),this.points.length>3){for(let n=0;n<this.points.length-2;n++){const p=new i.a.Geom.Line(this.points[n].x,this.points[n].y,this.points[n+1].x,this.points[n+1].y);if(f=i.a.Geom.Intersects.LineToLine(w,p,g),f)break}f?(this.log.info("intersect"),this.graphics.clear(),this.graphics.lineStyle(16,65280,.5),this.points.length=0,this.drawing=!1):this.points.push(new i.a.Geom.Point(this.spider.x,this.spider.y))}else this.points.push(new i.a.Geom.Point(this.spider.x,this.spider.y))}shutdown(){this.crash.clear(),this.input.off("pointerdown",this.pressDown,this),this.input.off("pointerup",this.pressUp,this),this.restartBtn.off("click"),this.joystick.off("update",this.dumpJoyStickState,this),super.shutdown()}}var G=Object.assign;M.a.disablePageScroll(),b.a.useDefaults(),b.a.setLevel(b.a.OFF);const v=b.a.get("index");v.info("start");const q={global:[{key:"rexWebFontLoader",plugin:N.a,start:!0},{key:"rexButtonn",plugin:C.a,start:!0,mapping:"rexButtonn"},{key:"rexVirtualJoystick",plugin:I.a,start:!0,mapping:"rexVirtualJoystick"}],scene:[]};window.onload=()=>{window.game=new i.a.Game(G(G({},z),{plugins:q,scene:[B,$],callbacks:{preBoot:s=>{v.info("game booting start")},postBoot:s=>{v.info("game booting complete"),window.scrollTo(0,1),s.scale.resize(window.innerWidth*x,S()()*x),X.add(()=>{s.scale.resize(window.innerWidth*x,S()()*x)})}}}))}}},[[20,1,2]]]);
