(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{17:function(y,T,t){y.exports=t(40)},18:function(y,T,t){var A=t(19),l=t(20);l=l.__esModule?l.default:l,typeof l=="string"&&(l=[[y.i,l,""]]);var a={};a.insert="head",a.singleton=!1;var C=A(l,a);y.exports=l.locals||{}},20:function(y,T,t){},40:function(y,T,t){"use strict";t.r(T);var A=t(18),l=t(0),a=t.n(l),C=t(1),E=t.n(C),G=t(9),P=t.n(G),B=t(16),V=t(15),X=t(14);const I={type:a.a.AUTO,disableContextMenu:!0,render:{transparent:!0},scale:{parent:"gameContainer",mode:a.a.Scale.FIT,autoCenter:a.a.Scale.CENTER_BOTH,width:640,height:960,expandParent:!1},physics:{default:"arcade",arcade:{debug:!1,gravity:{x:0,y:0}}}};class j extends a.a.Scene{constructor(s){super(s);this.key=s.key,this.log=E.a.get(this.key),this.log.info("boot")}init(){this.log.info("init"),this.events.once("shutdown",this.shutdown,this),this.events.once("sleep",this.sleep,this),this.events.once("pause",this.pause,this),this.events.off("destroy",this.destroy,this)}shutdown(){this.log.info("shutdown"),this.events.off("sleep",this.sleep,this),this.events.off("pause",this.pause,this),this.events.once("destroy",this.destroy,this)}sleep(){this.log.info("sleep"),this.events.off("pause",this.pause,this),this.events.once("wake",this.wake,this)}pause(){this.log.info("pause"),this.events.once("resume",this.resume,this)}wake(){this.log.info("wake"),this.events.once("sleep",this.sleep,this),this.events.once("pause",this.pause,this)}resume(){this.log.info("resume"),this.events.once("pause",this.pause,this)}destroy(){this.log.info("destroy"),this.events.off("sleep",this.sleep,this),this.events.off("pause",this.pause,this),this.events.off("shutdown",this.shutdown,this),this.log=void 0}}class F extends j{constructor(){super({key:"BootScene"})}create(){this.log.info("create"),this.load.rexWebFont({google:{families:["Roboto"]}}),this.load.json("chainsmail_matter","assets/jsons/chainsmail_matter.json"),this.load.image("level_bg","assets/images/level_bg.jpg"),this.load.image("restart","assets/images/restart.png"),this.load.image("hammer","assets/images/hammer.png"),this.load.image("hand","assets/images/hand.png"),this.load.image("ring","assets/images/ring.png"),this.load.on("complete",()=>{document.querySelector(".loader").classList.toggle("loaded"),this.scene.start("LevelScene")}),this.load.start()}}var J=t(12),Y=t.n(J),$=t(13),W=t.n($);class z{constructor(s,e,h,d,i,m=10,u=!1){this.scene=s,this.log=E.a.get("ChainsMail");const{SAT:r}=e,g=i.map(n=>{const o=new W.a(n);o.winding()&&o.rewind(!1);const c=o.points.map(({x,y:S})=>new r.Vector(x,S));return new r.Polygon(new r.Vector,c)});let v=g[0].points[0].x,p=g[0].points[0].x,L=g[0].points[0].y,D=g[0].points[0].y;g.forEach(n=>{n.points.forEach(({x:o,y:c})=>{o<v&&(v=o),o>p&&(p=o),c<L&&(L=c),c>D&&(D=c)})}),this.log.info("bbBox:",v,L,p,D);const N=Math.ceil((p-v)/8)+4,b=Math.ceil((D-L)/8)+4,Q=N*8,Z=b*8,U=Q*.5,k=Z*.5;let f;u?f=this.scene.add.graphics():f=this.scene.make.graphics();const _=new a.a.Display.Color;f.fillStyle(16777215),f.beginPath(),g.forEach(n=>{n.translate(h-U+12,d-k),u&&f.fillStyle(_.random(50).color),f.fillPoints(n.points,!1,!0)});const q=f.createGeometryMask(),O=[];for(let n=0;n<N;n++)for(let o=0;o<b;o++){const c=h-U+(n%2===0?8:0)+n*8,x=d-k+o*8,S=new r.Circle(new r.Vector(c,x),8);if(g.some(w=>r.testPolygonCircle(w,S))){const w=this.scene.add.image(c,x,"ring").setScale(.5).setOrigin(.5).setTint(7303032).setData("health",5).setData("isGold",!1);new e.Circle(new e.V(c,x),8,!0,{img:w}),O.push(w),u||w.setMask(q)}}this.numRings=O.length;for(let n=0;n<m;n++)a.a.Utils.Array.GetRandom(O).setTint(10910720).setData("isGold",!0)}}class H extends j{constructor(){super({key:"LevelScene"});this.currentPointer=null,this.hammerTween=null,this.crash=new Y.a,this.numGolds=10}create(){this.log.info("create");const{centerX:s,centerY:e,width:h,height:d}=this.cameras.main;this.add.image(s,e,"level_bg"),this.chainsMail=new z(this,this.crash,s,e,this.cache.json.get("chainsmail_matter").chainsmail.fixtures[0].vertices,this.numGolds,!1),this.numRings=this.chainsMail.numRings;const i=this.add.image(s-125,0,"hand").setScale(1,-1).setOrigin(.5,0),m=this.add.image(s+125,0,"hand").setScale(-1,-1).setOrigin(.5,0);this.tweens.add({targets:[i,m],y:200,duration:200}),this.hands=[i,m],this.hammerGoal=this.add.circle(0,0,32,16711680,.5),this.hammer=this.physics.add.image(h,d-50,"hammer").setOrigin(.8,.8),this.resp=new this.crash.Response,this.numRingsText=this.add.text(s,d-70,`RINGS IN MAIL: ${this.numRings}`,{fontFamily:"Roboto",fontSize:"32px",color:"#ffffff",align:"center"}).setOrigin(.5,1),this.numGoldsText=this.add.text(s,d-30,`GOLDS IN MAIL: ${this.numGolds}`,{fontFamily:"Roboto",fontSize:"32px",color:"#ffffff",align:"center"}).setOrigin(.5,1),this.joystick=this.rexVirtualJoystick.add(this,{x:400,y:300,radius:100,base:this.add.circle(0,0,100,16777215,.5),thumb:this.add.circle(0,0,50,2290649224,.5),enable:!1}).setVisible(!1).on("update",this.dumpJoyStickState,this),this.crash.onCollision(this.onCollition.bind(this)),this.restartBtn=this.rexButtonn.add(this.add.image(h-10,10,"restart").setScale(.4).setOrigin(1,0)).setEnable(!0).on("click",()=>{this.restartGame()}),this.input.on("pointerdown",this.pressDown,this),this.input.on("pointerup",this.pressUp,this)}dumpJoyStickState(){const{forceX:s,forceY:e}=this.joystick;this.hammer.setVelocity(s,e)}pressDown(s){if(this.currentPointer!==null)return;this.currentPointer=s;const{x:e,y:h}=s;this.joystick.setPosition(e,h).setVisible(!0).setEnable(!0),this.hammerTween=this.tweens.add({targets:[this.hammer],angle:-15,yoyo:!0,duration:150,repeat:-1,onYoyo:()=>{this.hammerBoom()}})}pressUp(s){if(this.currentPointer!==s)return;this.currentPointer=null,this.joystick.setVisible(!1).setEnable(!1),this.hammerTween!==null&&this.hammerTween.stop(),this.hammerTween=null,this.hammer.angle=0}onCollition(s,e,h,d){const i=e.data.img,m=i.getData("health")-1;i.setData("health",m),m<=0&&(this.numRingsText.setText(`RINGS IN MAIL: ${--this.numRings}`),this.crash.remove(e),i.getData("isGold")?(this.numGoldsText.setText(`GOLDS IN MAIL: ${--this.numGolds}`),i.clearMask(),this.tweens.add({targets:[i],scale:.8,duration:150,onComplete:()=>{let u=0,r=a.a.Math.Distance.BetweenPoints(this.hands[u],i);this.hands.forEach((g,v)=>{const p=a.a.Math.Distance.BetweenPoints(g,i);p<r&&(u=v,r=p)}),this.tweens.add({targets:[i],x:this.hands[u].x,y:this.hands[u].y,duration:r*5,onComplete:()=>{i.destroy()}})}})):this.tweens.add({targets:[i],alpha:0,duration:150,onComplete:()=>{i.destroy()}}))}restartGame(){this.log.info("click restart"),this.scene.restart()}hammerBoom(){const{x:s,y:e}=this.hammerGoal,h=new this.crash.Circle(new this.crash.Vector(s,e),32),d=new this.crash.Response;this.crash.testAll(h,d)}update(s,e){this.hammerGoal.x=this.hammer.x-225,this.hammerGoal.y=this.hammer.y-25}shutdown(){this.crash.clear(),this.input.off("pointerdown",this.pressDown,this),this.input.off("pointerup",this.pressUp,this),this.restartBtn.off("click"),this.joystick.off("update",this.dumpJoyStickState,this),super.shutdown()}}var R=Object.assign;P.a.disablePageScroll(),E.a.useDefaults(),E.a.setLevel(E.a.OFF);const M=E.a.get("index");M.info("start");const K={global:[{key:"rexWebFontLoader",plugin:B.a,start:!0},{key:"rexButtonn",plugin:V.a,start:!0,mapping:"rexButtonn"},{key:"rexVirtualJoystick",plugin:X.a,start:!0,mapping:"rexVirtualJoystick"}],scene:[]};window.onload=()=>{window.game=new a.a.Game(R(R({},I),{plugins:K,scene:[F,H],callbacks:{preBoot:s=>{M.info("game booting start")},postBoot:s=>{M.info("game booting complete")}}}))}}},[[17,1,2]]]);
